<ui:composition template="/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<ui:define name="content">

		<h2>הגדרת סיסמה חדשה</h2>


		<h:panelGroup rendered="#{not userBean.loggedIn}">
			<h2>גישה נדחתה 🚫</h2>
			<p>עליך להתחבר כדי להשתמש בדף זה.</p>
			<h:link outcome="login" value="לחץ כאן כדי להתחבר"
				styleClass="link-button" />
		</h:panelGroup>

		<h:panelGroup rendered="#{userBean.loggedIn}">
			<h:form id="pwdForm" prependId="false" styleClass="simple-form">

				<!-- General Messages -->
				<h:messages globalOnly="true" layout="list" styleClass="msg-global" />

				<!-- New password -->
				<h:outputLabel for="newPass" value="סיסמה חדשה:" />
				<h:inputSecret id="newPass" value="#{userBean.password}"
					required="true" requiredMessage="יש להזין סיסמה" redisplay="false"
					validatorMessage="סיסמה חייבת להכיל לפחות 7 תווים, כולל אות גדולה, אות קטנה, מספר ותו מיוחד"
					styleClass="input-field">
					<f:validateLength minimum="7" />
					<f:validateRegex
						pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{7,}$" />
				</h:inputSecret>
				<h:message for="newPass" style="color:red" />



				<!-- Confirm password -->
				<h:outputLabel for="confirmPass" value="אישור סיסמה:" />
				<h:inputSecret id="confirmPass" value="#{userBean.confirmPassword}"
					required="true" requiredMessage="יש לאשר סיסמה" redisplay="false"
					styleClass="input-field" />
				<h:message for="confirmPass" styleClass="msg-field" />

				<br />
				<br />

				<!-- Buttons -->
				<div class="form-actions">
					<h:commandButton value="עדכן סיסמה"
						action="#{userBean.changePassword}" styleClass="primary-button" />
					|
					<h:button outcome="profile" value=" חזרה לפרופיל"
						styleClass="primary-button" />
				</div>

			</h:form>
		</h:panelGroup>


	</ui:define>
</ui:composition>
